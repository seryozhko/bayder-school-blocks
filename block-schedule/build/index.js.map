{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./src/attributes.js","webpack:///./src/edit.js","webpack:///./src/index.js","webpack:///./src/save.js","webpack:///external {\"this\":[\"wp\",\"element\"]}"],"names":["attributes","venues","type","default","wp","components","CheckboxControl","ToggleControl","PanelBody","PanelRow","RangeControl","SelectControl","TextControl","Fragment","element","withSelect","data","blockEditor","InspectorControls","InnerBlocks","getBlockList","schedules","select","getBlocks","filter","block","name","length","innerBlocks","map","venueId","blockList","subscribe","addVenue","venue","clientId","blockTable","blocks","createBlock","id","title","rendered","dispatch","insertBlock","removeVenue","blockId","getBlock","item","removeBlock","locations","getEntityRecords","hide_empty","parent","location","includes","isChecked","registerBlockType","description","icon","category","edit","mapEdit","save","mapSave"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","const attributes = {\r\n  venues: {\r\n    type: 'array',\r\n    default: [],\r\n  },\r\n};\r\n\r\nexport default attributes;","const {\tCheckboxControl, ToggleControl, PanelBody, PanelRow, RangeControl, SelectControl, TextControl } = wp.components;\r\nconst {\tFragment } = wp.element;\r\nconst { withSelect } = wp.data;\r\nconst { InspectorControls, InnerBlocks } = wp.blockEditor;\r\n\r\nconst getBlockList = () => {\r\n  const schedules = wp.data.select( 'core/block-editor' ).getBlocks().filter(block => block.name === 'bayder-school/block-schedule');\r\n  return schedules.length ? schedules[0].innerBlocks.map(block => block.attributes.venueId) : [];\r\n};\r\nlet blockList = getBlockList();\r\nwp.data.subscribe(() => blockList = getBlockList());\r\n\r\nconst addVenue = (venue, clientId) => {\r\n  const blockTable = wp.blocks.createBlock( 'bayder-school/block-table', { venueId: venue.id, title: venue.title.rendered } );\r\n  wp.data.dispatch('core/block-editor').insertBlock( blockTable, 100, clientId, false );\r\n};\r\n\r\nconst removeVenue = (venue, clientId) => {\r\n  const blockId = wp.data.select(\"core/block-editor\").getBlock(clientId).innerBlocks.filter(item => item.attributes.venueId === venue.id)[0].clientId;\r\n  wp.data.dispatch( 'core/block-editor' ).removeBlock(blockId, false);\r\n};\r\n\r\nexport default withSelect( select => {\r\n  const locations = select( 'core' ).getEntityRecords( 'taxonomy', 'locations', { hide_empty:true, parent:0 } );\r\n  const venues = locations ? select( 'core' ).getEntityRecords( 'postType', 'venues', { locations: locations.map(location => location.id) } ) : [];\r\n  return { \r\n    locations : locations && venues ? locations.map( location => ({ ...location, venues: venues.filter( venue => venue.locations.includes(location.id) ) }) ) : [],\r\n  };\r\n} )(({ locations, clientId }) => \r\n  (<div>\r\n    Залы и Расписание\r\n    <InnerBlocks renderAppender={ () => (<div></div>) }/>\r\n    <InspectorControls>\r\n      <Fragment>\r\n        { locations && locations.map(location => \r\n          <PanelBody title={ location.name }>\r\n            { location.venues && location.venues.map(venue =>\r\n              <PanelRow>\r\n                <CheckboxControl\r\n                  label={ venue.title.rendered }\r\n                  checked={ blockList.includes(venue.id) }\r\n                  onChange={ isChecked => isChecked ? addVenue(venue, clientId) : removeVenue(venue, clientId) }\r\n                />\r\n              </PanelRow>\r\n            ) }\r\n          </PanelBody>\r\n        ) }\r\n      </Fragment>\r\n    </InspectorControls>\r\n  </div>));","const { registerBlockType } = wp.blocks;\r\n\r\nimport attributes from './attributes';\r\nimport mapEdit from './edit';\r\nimport mapSave from './save';\r\n\r\nregisterBlockType( 'bayder-school/block-schedule', {\r\n\ttitle: 'Залы и Расписание',\r\n\tdescription: 'Выберите залы, чтобы добавить расписание',\r\n\ticon: 'calendar-alt',\r\n\tcategory: 'bayder-school',\r\n\t// supports: {\r\n\t// \thtml: false,\r\n\t// \tclassName: false,\r\n\t// },\r\n\tattributes,\r\n\tedit: mapEdit,\r\n\tsave: mapSave,\r\n} );\r\n","const { InnerBlocks } = wp.blockEditor;\r\n\r\nexport default () => (<div>\r\n  <InnerBlocks.Content />\r\n</div>);\r\n","(function() { module.exports = this[\"wp\"][\"element\"]; }());"],"sourceRoot":""}