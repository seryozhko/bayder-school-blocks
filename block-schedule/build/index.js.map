{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./src/attributes.js","webpack:///./src/edit.js","webpack:///./src/index.js","webpack:///./src/save.js","webpack:///external {\"this\":[\"wp\",\"element\"]}"],"names":["attributes","venues","type","default","wp","components","CheckboxControl","ToggleControl","PanelBody","PanelRow","RangeControl","SelectControl","TextControl","Fragment","element","withSelect","data","blockEditor","InspectorControls","InnerBlocks","addVenue","venue","clientId","blockTable","blocks","createBlock","venueId","id","title","rendered","dispatch","insertBlock","removeVenue","blockId","select","getBlock","innerBlocks","filter","item","removeBlock","scheduleBlock","locations","setAttributes","thisBlock","blockList","map","block","tables","length","JSON","stringify","index","updateBlockAttributes","location","name","find","undefined","isChecked","getLocations","getEntityRecords","hide_empty","parent","includes","registerBlockType","description","icon","category","supports","html","className","multiple","reusable","edit","mapEdit","save","mapSave"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","const attributes = {\r\n  venues: {\r\n    type: 'array',\r\n    default: [],\r\n  },\r\n};\r\n\r\nexport default attributes;","const {\tCheckboxControl, ToggleControl, PanelBody, PanelRow, RangeControl, SelectControl, TextControl } = wp.components;\r\nconst {\tFragment } = wp.element;\r\nconst { withSelect } = wp.data;\r\nconst { InspectorControls, InnerBlocks } = wp.blockEditor;\r\n\r\nconst addVenue = (venue, clientId) => {\r\n  const blockTable = wp.blocks.createBlock( 'bayder-school/location', { venueId: venue.id, title: venue.title.rendered } );\r\n  wp.data.dispatch('core/block-editor').insertBlock( blockTable, 100, clientId, false );\r\n};\r\n\r\nconst removeVenue = (venue, clientId) => {\r\n  const blockId = wp.data.select(\"core/block-editor\").getBlock(clientId).innerBlocks.filter(item => item.attributes.venueId === venue.id)[0].clientId;\r\n  wp.data.dispatch( 'core/block-editor' ).removeBlock(blockId, false);\r\n};\r\n\r\nconst scheduleBlock = ({ locations, clientId, setAttributes, attributes:{ venues } }) => \r\n{\r\n  const thisBlock = wp.data.select( 'core/block-editor' ).getBlock(clientId);\r\n  const blockList = thisBlock.innerBlocks.map(block => ({ id:block.attributes.venueId, title:block.attributes.title, tables:block.innerBlocks.length }));\r\n  \r\n  if (JSON.stringify(blockList) !== JSON.stringify(venues)) {\r\n    setAttributes({ venues: blockList });\r\n    thisBlock.innerBlocks.map((block, index) => {\r\n      wp.data.dispatch( 'core/block-editor' ).updateBlockAttributes( block.clientId, { index } )\r\n    });\r\n  }\r\n \r\n  return (<div>\r\n    <InspectorControls>\r\n      <Fragment>\r\n        { locations && locations.map(location => \r\n          <PanelBody title={ location.name }>\r\n            { location.venues && location.venues.map(venue =>\r\n              <PanelRow>\r\n                <CheckboxControl\r\n                  label={ venue.title.rendered }\r\n                  checked={ blockList.find(item => item.id === venue.id) !== undefined }\r\n                  onChange={ isChecked => isChecked ? addVenue(venue, clientId) : removeVenue(venue, clientId) }\r\n                />\r\n              </PanelRow>\r\n            ) }\r\n          </PanelBody>\r\n        ) }\r\n      </Fragment>\r\n    </InspectorControls>\r\n    Залы и Расписание  \r\n    <div class=\"tab-content\" id=\"nav-tabContent\">\r\n      <InnerBlocks\r\n        allowedBlocks={['bayder-school/location']}\r\n        renderAppender={ () => (<div></div>) }/>\r\n    </div>\r\n  </div>)};\r\n\r\nconst getLocations = select => {\r\n  const locations = select( 'core' ).getEntityRecords( 'taxonomy', 'locations', { hide_empty:true, parent:0 } );\r\n  const venues = locations ? select( 'core' ).getEntityRecords( 'postType', 'venues', { locations: locations.map(location => location.id) } ) : [];\r\n  return { \r\n    locations : locations && venues ? locations.map( location => ({ ...location, venues: venues.filter( venue => venue.locations.includes(location.id) ) }) ) : [],\r\n  };\r\n};\r\n\r\nexport default withSelect(getLocations)(scheduleBlock);","const { registerBlockType } = wp.blocks;\r\n\r\nimport attributes from './attributes';\r\nimport mapEdit from './edit';\r\nimport mapSave from './save';\r\n\r\nregisterBlockType( 'bayder-school/schedule', {\r\n\ttitle: 'Залы и Расписание',\r\n\tdescription: 'Выберите залы, чтобы добавить расписание',\r\n\ticon: 'calendar-alt',\r\n\tcategory: 'bayder-school',\r\n\tsupports: {\r\n\t\thtml: false,\r\n\t\tclassName: false,\r\n\t\tmultiple: false,\r\n\t\treusable: false,\r\n\t\t// anchor: true,\r\n\t},\r\n\tattributes,\r\n\tedit: mapEdit,\r\n\tsave: mapSave,\r\n} );\r\n","const { InnerBlocks } = wp.blockEditor;\r\n\r\nexport default ({ attributes: { venues } }) => (<div>\r\n  <nav>\r\n    <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\">\r\n      {\r\n        venues.map((venue, index) => \r\n          venue.tables ? \r\n          (<a\r\n            class={`nav-item nav-link ${index ? '' : 'active'}`}\r\n            data-toggle=\"tab\"\r\n            id={ `${venue.id}-tab` }\r\n            href={ `#nav-${venue.id}` }\r\n            role=\"tab\"\r\n            aria-controls={ `nav-${venue.id}` }\r\n            aria-selected=\"true\"\r\n          >\r\n            { venue.title }\r\n          </a>) :\r\n          null\r\n        )\r\n      }        \r\n    </div>\r\n  </nav>\r\n  \r\n  <div class=\"tab-content\" id=\"nav-tabContent\">\r\n    <InnerBlocks.Content />\r\n  </div>\r\n</div>);\r\n","(function() { module.exports = this[\"wp\"][\"element\"]; }());"],"sourceRoot":""}