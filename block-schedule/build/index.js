!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t,n){var r=n(6),o=n(5),c=n(4);e.exports=function(e){return r(e)||o(e)||c()}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";n.r(t);var r={};n.d(r,"name",function(){return D}),n.d(r,"settings",function(){return T});var o={};n.d(o,"name",function(){return W}),n.d(o,"settings",function(){return X});var c={};n.d(c,"name",function(){return re}),n.d(c,"settings",function(){return oe});var l={venues:{type:"array",default:[]}},a=n(2),i=n.n(a),u=n(1),s=n.n(u),d=n(0);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var m=wp.components,f=m.CheckboxControl,g=(m.ToggleControl,m.PanelBody),y=m.PanelRow,v=(m.RangeControl,m.SelectControl,m.TextControl,m.Button,wp.element.Fragment),h=wp.data,k=h.withSelect,O=h.withDispatch,w=wp.data,j=w.useDispatch,E=w.useSelect,C=wp.compose.compose,B=wp.blockEditor,x=B.InspectorControls,I=B.InnerBlocks,P=[],S=C(k(function(e,t){var n=t.clientId,r=e("core/block-editor").getBlocks(n).map(function(e){return{id:e.attributes.venueId,title:e.attributes.title,tables:e.innerBlocks.length}}),o=e("core").getEntityRecords("taxonomy","locations",{hide_empty:!0,parent:0}),c=o?e("core").getEntityRecords("postType","venues",{locations:o.map(function(e){return e.id}),per_page:100}):[];return{blockList:r,locations:o&&c?o.map(function(e){return b({},e,{venues:c.filter(function(t){return t.locations.includes(e.id)})})}):[]}}),O(function(e,t,n){var r=t.clientId,o=(0,n.select("core/block-editor").getBlocks)(r);return{updateVenues:function(){var t=e("core/block-editor").updateBlockAttributes;o.map(function(e,n){return t(e.clientId,{index:n})})},removeVenue:function(t){(0,e("core/block-editor").removeBlock)(o.filter(function(e){return e.attributes.venueId===t.id})[0].clientId,!1)},addVenue:function(t){(0,e("core/block-editor").insertBlock)(wp.blocks.createBlock("bayder-school/location",t),100,r,!1)}}}))(function(e){var t=e.addVenue,n=e.removeVenue,r=e.updateVenues,o=e.setAttributes,c=e.blockList,l=e.locations;if(JSON.stringify(P)!==JSON.stringify(c)){P=s()(c);var a=E(function(e){return e("core/editor").getEditedPostAttribute("meta")});j("core/editor").editPost({meta:b({},a,{venueIds:JSON.stringify(P.map(function(e){return e.id}))})}),o({venues:P}),r()}return Object(d.createElement)("div",null,Object(d.createElement)(x,null,Object(d.createElement)(v,null,l&&l.map(function(e){return Object(d.createElement)(g,{title:e.name},e.venues&&e.venues.map(function(e){return Object(d.createElement)(y,null,Object(d.createElement)(f,{label:e.title.rendered,checked:void 0!==c.find(function(t){return t.id===e.id}),onChange:function(r){return r?t({venueId:e.id,title:e.title.rendered,point:e.meta.point,zoom:e.meta.zoom,venueAddress:e.meta.venueAddress,baloonContent:e.meta.baloonContent}):n(e)}}))}))}))),"Залы и Расписание",Object(d.createElement)("div",null,Object(d.createElement)(I,{allowedBlocks:["bayder-school/location"],renderAppender:function(){return Object(d.createElement)("div",null)}})))}),A=wp.blockEditor.InnerBlocks,D="bayder-school/schedule",T={title:"Залы и Расписание",description:"Выберите залы, чтобы добавить расписание",icon:"calendar-alt",category:"bayder-school",supports:{html:!1,className:!1,multiple:!1,reusable:!1},attributes:l,edit:S,save:function(){return Object(d.createElement)(A.Content,null)}},N={venueId:{type:"number"},title:{type:"string"},index:{type:"number"},tablesCount:{type:"number"},zoom:{type:"number",default:16},point:{type:"string"},venueAddress:{type:"string"},baloonContent:{type:"string"}},R=wp.components,_=(R.CheckboxControl,R.ToggleControl,R.PanelBody),V=(R.PanelRow,R.RangeControl,R.SelectControl,R.TextControl,R.Button),F=(R.Toolbar,wp.element.Fragment),L=wp.blockEditor,z=L.InspectorControls,J=L.InnerBlocks,M=(L.BlockControls,wp.data),U=(M.withSelect,M.withDispatch,wp.data),q=U.useDispatch,G=U.useSelect,H=(wp.compose.compose,[["bayder-school/table"]]),K=[],Q=wp.blockEditor.InnerBlocks,W="bayder-school/location",X={title:"Зал",description:"",icon:"location",category:"bayder-school",parent:["bayder-school/schedule"],supports:{html:!1,className:!1,inserter:!1,reusable:!1},attributes:N,edit:function(e){var t=e.attributes,n=t.title,r=t.tablesCount,o=e.setAttributes,c=e.clientId,l=G(function(e){return e("core/block-editor").getBlockOrder(c).length>0}),a=q("core/block-editor").insertBlock;return l&&void 0===r&&o({tablesCount:1}),Object(d.createElement)("div",null,n,Object(d.createElement)(z,null,Object(d.createElement)(F,null,Object(d.createElement)(_,null,Object(d.createElement)(V,{isDefault:!0,isDestructive:!0,onClick:function(){return a(wp.blocks.createBlock("bayder-school/table"),100,c,!1)}},"Добавить Таблицу расписания")))),Object(d.createElement)(J,{template:l||void 0===r?H:K,template_lock:!1,allowedBlocks:["bayder-school/table"],renderAppender:function(){return Object(d.createElement)("div",null)},templateInsertUpdatesSelection:!1}))},save:function(){return Object(d.createElement)(Q.Content,null)}},Y=wp.components,Z=(Y.CheckboxControl,Y.ToggleControl,Y.PanelBody,Y.PanelRow,Y.RangeControl,Y.SelectControl,Y.TextControl,Y.Button),$=(wp.element.Fragment,wp.blockEditor),ee=($.InspectorControls,$.InnerBlocks),te=[["core/heading",{placeholder:"Расписание занятий",className:"text-light bg-primary text-uppercase p-2",level:5,content:"Расписание занятий",align:"center"}],["core/table",{className:"table table-bordered",hasFixedLayout:!0,head:[],body:[{cells:[{content:"Понедельник",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]},{cells:[{content:"Вторник",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]},{cells:[{content:"Среда",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]},{cells:[{content:"Четверг",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]},{cells:[{content:"Пятница",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]},{cells:[{content:"Суббота",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]},{cells:[{content:"Воскресенье",tag:"td"},{content:"",tag:"td",align:"center"},{content:"",tag:"td",align:"center"}]}],foot:[]}],["core/paragraph",{placeholder:"Комментарий"}]],ne=wp.blockEditor.InnerBlocks,re="bayder-school/table",oe={title:"Таблица расписания",description:"",icon:"editor-table",category:"bayder-school",parent:["bayder-school/location"],supports:{html:!1,className:!1,inserter:!1,reusable:!1},edit:function(e){e.attributes.title;var t=e.clientId;e.isSelected;return Object(d.createElement)("div",null,Object(d.createElement)(ee,{template:te,templateLock:"all",templateInsertUpdatesSelection:!1}),Object(d.createElement)(Z,{isPrimary:!0,isDestructive:!0,onClick:function(){return wp.data.dispatch("core/block-editor").removeBlock(t,!1)}},"Удалить эту таблицу"))},save:function(){return Object(d.createElement)(ne.Content,null)}},ce=wp.blocks.registerBlockType;[r,o,c].forEach(function(e){if(e){var t=e.name,n=e.settings;ce(t,n)}})},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}}]);